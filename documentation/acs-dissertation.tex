%% 
%% ACS project dissertation template. 
%% 
%% Currently designed for printing two-sided, but if you prefer to 
%% print single-sided just remove ",twoside,openright" from the 
%% \documentclass[] line below. 
%%
%%
%%   SMH, May 2010. 

\documentclass[a4paper,12pt,twoside,openright]{report}
\usepackage{graphicx}

%%
%% EDIT THE BELOW TO CUSTOMIZE
%%

\def\authorname{Martin Marinov\xspace}
\def\authorcollege{St Edmund's College\xspace}
\def\authoremail{mtm46@cam.ac.uk}
\def\dissertationtitle{Remote Video Eavesdropping Using a Software Defined Radio Platform}
\def\wordcount{??,???}


\usepackage{epsfig,graphicx,parskip,setspace,tabularx,xspace,epstopdf} 
\graphicspath{ {./images/} }

%% START OF DOCUMENT
\begin{document}


%% FRONTMATTER (TITLE PAGE, DECLARATION, ABSTRACT, ETC) 
\pagestyle{empty}
\singlespacing
\input{titlepage}
\onehalfspacing
\input{declaration}
\singlespacing
\input{abstract}

\pagenumbering{roman}
\setcounter{page}{0}
\pagestyle{plain}
\tableofcontents
%% \listoffigures
%% \listoftables

\onehalfspacing

%% START OF MAIN TEXT 

\chapter{Introduction}
\pagenumbering{arabic} 
\setcounter{page}{1} 

\section{Related Work} 

[Related work and critique]

\section{Availability} 
[Github repo url]

\cite{kuhn2003compromising}

\chapter{Background}

\section{Electronic Emanations} 

\section{IQ sampling} 

\chapter{Methodology} 

\section{Anatomy of a Video Signal}

Almost all contemporary video monitors are raster based. The image is transferred from the video controller to the display in scanlines that occur at a specific rate. Each of these scanlines contains a number of pixels which are continuously encoded as a time varying signal. This signal is generated internally in the video controller by an oscillator which runs at the pixel clock rate. The signal is thereafter multiplied by the pixel intensities at the specific time.

Let's assume that the signal started transmitting at time $t=0$, and each video frame contains $h$ scanlines, each of which contains $w$ pixels. The frequency with which frames are being generated is $f$ frames per second. Therefore the duration of transmission of each individual pixel is $$T_{\Delta}=\frac{1}{w h f}$$ Furthermore at time $t$ frame number $n_{t}$ started transmission where $$n_{t}=\lfloor t f \rfloor$$ Therefore if we assume that the top left corner of a frame has coordinates $(0, 0)$, a pixel at position $(x, y)$ in frame $n_{t}$ will start to be transmitted at time $$T_{(x,y)}= (y w + x + n_{t} w h) T_{\Delta} $$ and will finish transmission before time $$T_{(x+1,y)} = T_{(x,y)} + T_{\Delta} =(y w + x + 1 + n_{t} w h) T_{\Delta} $$ at which the next pixel will start transmitting.

In practice $w$ and $h$ are determined by the screen resolution and $f$ is simply the screen refresh rate. For a typical screen resolution of $width \times height$, it is true that $w \geq width$ and $h \geq height$. The reason is that video signals tend to have additional blanking intervals. This means more pixels are transmitted than what is in the active video region. This gives opportunity for the receiving monitor to synchronise its internal clock, calibrate its colour levels or in case of CRT, allow enough time for the electron beam to return to the beginning of the next line on the screen. The synchronisation timings for personal computers have been standardised by Video Electronics Standards Association (VESA) \cite{vesa}.

In order to decode an individual pixel, the receiving monitor has its own internal oscillator. It locks it to the pixel rate of the incoming signal either via an external clock source or using the blanking intervals. Once it receives the signal for an individual pixel, the monitor will usually average it over the time from $T_{x,y}$ to $T_{x,y}+T_{\Delta}$. The amplitude of this average relates to pixel intensity. This allows the monitor to display the video in real time. If multiple colours are desired, the intensity of each of them (or some other combination) will be transmitted separately on different wires.

\section{Eavesdropping}

As we already know, a changing signal in a wire produces an electromagnetic field. Therefore the changing intensities of the pixels in the wires will produce electromagnetic waves. We can model the signal as a band limited signal with a maximum frequency component of $\nu_{max}=\frac{1}{T_{\Delta}}$. This signal will contain the full information that is required to reconstruct the transmitted image. In practice, the signal contains higher frequencies. This is due to the fact that the signal for each pixel is not smooth \cite{kuhn2003compromising}. However, the extra frequencies could be eliminated with a low pass filter which can produce the ideal band limited signal. If the band limited signal is written as $f(t)$, then its Fourier transform $F(t)$ will range from $-\frac{\nu_{max}{2}$ to $\frac{\nu_{max}{2}$ (all other elements will be zero).

[TODO! Do the derivation of the Fourier transform repetitions]

The Fourier transform of such a signal will therefore range from $-\frac{\nu_{max}{2}$ to $\frac{\nu_{max}{2}$ (all other elements will be zero). The lowest frequency components will be centred around DC while the highest one will span up to $\frac{\nu_{max}{2}$ in each direction. Therefore in order to fully reconstruct the signal, we will need to sample an output from an antenna with a rate of $\nu_{max}$. However, the video cables are usually much shorter than those wavelengths and therefore they don't emit efficiently in this range. 

[Discuss how IQ relates to AM and how it can be used to reconstruct video.]

[Explain how the whole system works in high level]

[TODO! Explain how resolution and framerate detection works]



\section{Sampling Rate}

[TODO! Explain how bandwidth relates to resolution width * height * framerate = samplerate ]

The sampling rate

\begin{figure}[h!]
\minipage{0.49\textwidth}
  \centering
    \includegraphics[width=0.5\textwidth]{sr_original}
  \caption{Transmitted image}
\endminipage\hfill
\minipage{0.49\textwidth}
  \centering
    \includegraphics[width=\linewidth]{sr_50MHz_at_190MHz}
  \caption{50 MHz}
\endminipage\hfill
\minipage{0.49\textwidth}
  \centering
    \includegraphics[width=\linewidth]{sr_40MHz_at_190MHz}
  \caption{40 MHz}
\endminipage\hfill
\minipage{0.49\textwidth}
  \centering
    \includegraphics[width=\linewidth]{sr_30MHz_at_190MHz}
  \caption{30 MHz}
\endminipage\hfill
\minipage{0.49\textwidth}
  \centering
    \includegraphics[width=\linewidth]{sr_20MHz_at_190MHz}
  \caption{20 MHz}
\endminipage\hfill
\minipage{0.49\textwidth}
  \centering
    \includegraphics[width=\linewidth]{sr_10MHz_at_190MHz}
  \caption{10 MHz}
\endminipage\hfill
\minipage{0.49\textwidth}
  \centering
    \includegraphics[width=\linewidth]{sr_5MHz_at_190MHz}
  \caption{5 MHz}
\endminipage
\end{figure}


\chapter{Practical attack} 

Before explaining how the software works internally, let's present a demonstration of a practical video eavesdropping attack. Its main aim is to show the ease with which such an attack could happen. In the meantime this will give an opportunity to explain the characteristics of the received signal and how they are exploited.

As in the real world, we will start with no knowledge of the victim's system. We will estimate the frequency at which the emission strength has the best Signal to Noise Ratio (SNR). We will then analyse the signal to detect the resolution and refresh rate of the screen. We will afterwards lock onto the signal and try to recover the original video. We will also discuss some techniques that could be utilized to improve the quality of the image.

\section{The Setup}

The choice for a SDR front-end for this demonstration is a USRP B200\footnote{Refer to \ref{sec:hw} Hardware for discussion on currently available SDR devices.}. Depending on the particular requirements, an attacker might prefer mobility over accuracy and choose the smaller Mirics FlexiTV\texttrademark MSi3101 SDR USB Dongle. However, for this demonstration we will attempt to obtain the highest possible resolution. Therefore we need an SDR radio that is capable of obtaining a wide bandwidth. This makes the 32 MHz of Bandwidth that the USRP provides a much better choice than the 8 MHz available from the Mirics dongle.

[Antenna]

[Location of victim]

[Victim's fonts]

\section{Preparation}

\chapter{Implementation} 

\section{Hardware}
\label{sec:hw} 

\begin{figure}[h!]
 
  \centering
    \includegraphics[width=0.9\textwidth]{equipment}
    \caption{From left to right: MSi3101, AverMedia antenna and USRP B200}
\end{figure}


\section{Architecture}

\subsection{Main Library}

\subsection{JavaGUI}

\subsubsection{Multiplatform}

\subsubsection{Graphical Interface}

\subsubsection{Visualisation}

\section{Digital Signal Processing}

\subsection{Overview}

\subsection{Signal Reconstruction}

\subsubsection{Multithreading}

\subsubsection{Demodulation}

\subsubsection{Re-sampling}

\subsubsection{Auto Gain}

\subsubsection{Low-pass}

\subsection{Frame Synchronization}

\subsection{Resolution Detection}

\subsection{Extended Bandwidth}

\subsection{Testing and Benchmarking}

\chapter{Summary and Conclusions} 

[Summarize results]

[potential future work]

\appendix
\singlespacing

\bibliographystyle{unsrt} 
\bibliography{dissertation} 

\end{document}
